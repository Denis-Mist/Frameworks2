๐ ะะธะบัะพัะตัะฒะธัะฝัะน ะฟัะพะตะบั ะฝะฐ FastAPI

ะญัะพั ะฟัะพะตะบั ะฟะพัััะพะตะฝ ะฝะฐ ะฐััะธัะตะบัััะต ะผะธะบัะพัะตัะฒะธัะพะฒ, ะฒะบะปััะฐะตั ะฝะตัะบะพะปัะบะพ ะพัะดะตะปัะฝัั ัะตัะฒะธัะพะฒ ะธ API Gateway, ะฐ ัะฐะบะถะต ะฟัะตะดะพััะฐะฒะปัะตั ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะณะตะฝะตัะธัะพะฒะฐะฝะฝัั ะดะพะบัะผะตะฝัะฐัะธั Swagger UI.

๐ฆ ะกะพััะฐะฒ ะฟัะพะตะบัะฐ

ะัะพะตะบั ัะพััะพะธั ะธะท ัะปะตะดัััะธั ัะตัะฒะธัะพะฒ:

ะกะตัะฒะธั	ะะฟะธัะฐะฝะธะต
service_users	ะะธะบัะพัะตัะฒะธั ัะฟัะฐะฒะปะตะฝะธั ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
service_orders	ะะธะบัะพัะตัะฒะธั ัะฟัะฐะฒะปะตะฝะธั ะทะฐะบะฐะทะฐะผะธ
api_gateway	ะะปะฐะฒะฝะฐั ัะพัะบะฐ ะฒัะพะดะฐ ะฒ ะฟัะธะปะพะถะตะฝะธะต, ะผะฐัััััะธะทะฐัะธั ะทะฐะฟัะพัะพะฒ, Swagger

ะะฐะถะดัะน ัะตัะฒะธั โ ะพัะดะตะปัะฝะพะต FastAPI-ะฟัะธะปะพะถะตะฝะธะต, ะทะฐะฟััะบะฐะตะผะพะต ะฒ Docker-ะบะพะฝัะตะนะฝะตัะต.

๐๏ธ ะจะฐะณ 6. ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ FastAPI-ะผะธะบัะพัะตัะฒะธัะพะฒ

ะะตัะตะนะดะธัะต ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ ะธ ะฒัะฟะพะปะฝะธัะต:

docker compose up -d --build

ะะพััะฝะตะฝะธะต ัะปะฐะณะพะฒ

--build โ ะฟัะธะฝัะดะธัะตะปัะฝะพ ะฟะตัะตัะพะฑะธัะฐะตั ะพะฑัะฐะทั.

-d โ ะทะฐะฟััะบะฐะตั ะบะพะฝัะตะนะฝะตัั ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต (daemon).

ะัะพะฒะตัะบะฐ ััะฐัััะฐ ะบะพะฝัะตะนะฝะตัะพะฒ:
docker ps


ะั ะดะพะปะถะฝั ัะฒะธะดะตัั ะบะพะฝัะตะนะฝะตัั:

service_users

service_orders

api_gateway

ะธ ะธั ััะฐััั ะดะพะปะถะตะฝ ะฑััั Up.

๐ ะจะฐะณ 7. ะัะพะฒะตัะบะฐ ัะฐะฑะพัั API
ะะพัะผะพััะตัั ะปะพะณะธ ะบะพะฝัะตะนะฝะตัะพะฒ:
docker compose logs api_gateway
docker compose logs service_users
docker compose logs service_orders


ะ ะปะพะณะฐั API Gateway ะดะพะปะถะฝะพ ะฑััั:

Uvicorn running on http://0.0.0.0:8000

๐งช ะัะพะฒะตัะบะฐ ะดะพัััะฟะฝะพััะธ API
ะัะพะฒะตัะธัั ะพัะฝะพะฒะฝะพะน ััะฐััั-ัะฝะดะฟะพะธะฝั:

ะะท WSL/Linux:

curl http://localhost:8000/status


ะะท ะฑัะฐัะทะตัะฐ Windows / Postman:

ะัะบัะพะนัะต:

http://localhost:8000/status

ะะถะธะดะฐะตะผัะน ะพัะฒะตั:
{
  "status": "API Gateway is running"
}

๐ Swagger / OpenAPI ะดะพะบัะผะตะฝัะฐัะธั

ะะพัะปะต ะทะฐะฟััะบะฐ ะฟัะพะตะบัะฐ Swagger UI ะดะพัััะฟะตะฝ ะฟะพ ะฐะดัะตัั:

http://localhost:8000/docs


ะขะฐะบะถะต ะดะพัััะฟะฝะฐ ะฐะปััะตัะฝะฐัะธะฒะฝะฐั ReDoc ะดะพะบัะผะตะฝัะฐัะธั:

http://localhost:8000/redoc


Swagger ะฐะฒัะพะผะฐัะธัะตัะบะธ ะฐะณัะตะณะธััะตั ัะฝะดะฟะพะธะฝัั ะฒะฐัะธั ะผะธะบัะพัะตัะฒะธัะพะฒ (ะตัะปะธ ะฒะบะปััะตะฝะฐ OpenAPI-ะฟัะพะบัะธัะพะฒะบะฐ ะธะปะธ ัะพะฑััะฒะตะฝะฝัะต ัััะบะธ API Gateway).

๐งฐ ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั
ะััะฐะฝะพะฒะธัั ะบะพะฝัะตะนะฝะตัั:
docker compose down

ะะตัะตะทะฐะฟัััะธัั ะฑะตะท ะฟะตัะตัะฑะพัะบะธ:
docker compose up -d

ะะตัะตัะพะฑัะฐัั ัะพะปัะบะพ ะพะดะธะฝ ัะตัะฒะธั:
docker compose build service_orders

๐ ะะธะบัะพัะตัะฒะธัะฝัะน ะฟัะพะตะบั ะฝะฐ FastAPI

ะญัะพั ะฟัะพะตะบั ัะตะฐะปะธะทัะตั ะฐััะธัะตะบัััั ะผะธะบัะพัะตัะฒะธัะพะฒ ะฝะฐ ะฑะฐะทะต FastAPI, Docker Compose ะธ API Gateway, ะฟัะตะดะพััะฐะฒะปัั ัะตะฝััะฐะปะธะทะพะฒะฐะฝะฝัั ัะพัะบั ะฒัะพะดะฐ, ะผะฐัััััะธะทะฐัะธั, ะฐะฒัะพัะธะทะฐัะธั ะธ ะพะฑััั ะดะพะบัะผะตะฝัะฐัะธั Swagger/OpenAPI.

ะัะพะตะบั ะปะตะณะบะพ ัะฐััะธััะตะผ, ะผะฐัััะฐะฑะธััะตะผ ะธ ัะดะพะฑะตะฝ ะดะปั ัะฐะทัะฐะฑะพัะบะธ ัะปะพะถะฝัั ัะธััะตะผ.

๐งฉ ะััะธัะตะบัััะฐ ะฟัะพะตะบัะฐ

ะะธะถะต ะฟัะตะดััะฐะฒะปะตะฝะฐ ะพะฑัะฐั ััะตะผะฐ:

                   โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ      Client (Web / App)  โ
                   โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโ
                                  โ
                                  โผ
                   โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                   โ       API Gateway        โ
                   โ  FastAPI + Swagger Docs  โ
                   โโโโโโโโโฌโโโโโโโโโฌโโโโโโโโโ
                           โ        โ
            โโโโโโโโโโโโโโโโ        โโโโโโโโโโโโโโโโ
            โผ                                       โผ
 โโโโโโโโโโโโโโโโโโโโโโโโ               โโโโโโโโโโโโโโโโโโโโโโโโ
 โ     service_users     โ               โ    service_orders     โ
 โ FastAPI microservice  โ               โ FastAPI microservice  โ
 โโโโโโโโโโโโโโโโโโโโโโโโ               โโโโโโโโโโโโโโโโโโโโโโโโ


API Gateway ะพัะฒะตัะฐะตั ะทะฐ:

ะผะฐัััััะธะทะฐัะธั ะทะฐะฟัะพัะพะฒ ะบ ะฝัะถะฝะพะผั ะผะธะบัะพัะตัะฒะธัั

ะฐะณัะตะณะฐัะธั ะดะพะบัะผะตะฝัะฐัะธะธ Swagger

ะฒะฐะปะธะดะฐัะธั ะทะฐะฟัะพัะพะฒ

ะตะดะธะฝัะน ะพัะฒะตั ะบะปะธะตะฝัั

๐ฆ ะกะพััะฐะฒ ะผะธะบัะพัะตัะฒะธัะพะฒ
ะกะตัะฒะธั	ะะฐะทะฝะฐัะตะฝะธะต
api_gateway	ะะปะฐะฒะฝะฐั ัะพัะบะฐ ะฒัะพะดะฐ, ะดะพะบัะผะตะฝัะฐัะธั, ะผะฐัััััั, ััะฐััั
service_users	ะะตะณะธัััะฐัะธั, ะฒัะพะด, ัะฟัะฐะฒะปะตะฝะธะต ะฟะพะปัะทะพะฒะฐัะตะปัะผะธ
service_orders	ะกะพะทะดะฐะฝะธะต ะธ ะฟะพะปััะตะฝะธะต ะทะฐะบะฐะทะพะฒ

ะะฐะถะดัะน ัะตัะฒะธั โ ัะฐะผะพััะพััะตะปัะฝะพะต FastAPI-ะฟัะธะปะพะถะตะฝะธะต.

๐ ะกัััะบัััะฐ ะฟัะพะตะบัะฐ

ะัะธะผะตัะฝะฐั ััััะบัััะฐ:

project/
โโโ api_gateway/
โ   โโโ main.py
โ   โโโ routers/
โ   โโโ ...
โ
โโโ service_users/
โ   โโโ main.py
โ   โโโ models/
โ   โโโ routers/
โ   โโโ ...
โ
โโโ service_orders/
โ   โโโ main.py
โ   โโโ models/
โ   โโโ routers/
โ   โโโ ...
โ
โโโ docker-compose.yml
โโโ README.md

โ๏ธ ะขัะตะฑะพะฒะฐะฝะธั

Docker

Docker Compose

WSL2 (ะตัะปะธ ัะฐะฑะพัะฐะตัะต ะฝะฐ Windows)

Python 3.10+ (ะพะฟัะธะพะฝะฐะปัะฝะพ)

๐ง ะะตัะตะผะตะฝะฝัะต ะพะบััะถะตะฝะธั (.env)

ะัะปะธ ะธัะฟะพะปัะทััััั .env ัะฐะนะปั, ััััะบัััะฐ ะผะพะถะตั ะฑััั ัะฐะบะพะน:

api_gateway/.env

GATEWAY_PORT=8000
USERS_SERVICE_URL=http://service_users:8001
ORDERS_SERVICE_URL=http://service_orders:8002


service_users/.env

SERVICE_PORT=8001
DB_URL=sqlite:///./users.db


service_orders/.env

SERVICE_PORT=8002
DB_URL=sqlite:///./orders.db


ะัะปะธ ัะพัะตัั โ ะผะพะณั ัะณะตะฝะตัะธัะพะฒะฐัั ััะธ ัะฐะนะปั.

๐๏ธ ะจะฐะณ 6. ะกะฑะพัะบะฐ ะธ ะทะฐะฟััะบ ะผะธะบัะพัะตัะฒะธัะพะฒ

ะะตัะตะนะดะธัะต ะฒ ะดะธัะตะบัะพัะธั ะฟัะพะตะบัะฐ ะธ ะฒัะฟะพะปะฝะธัะต:

docker compose up -d --build

ะะฐัะฐะผะตััั:

--build โ ะฟะตัะตัะพะฑัะฐัั ะฒัะต ะพะฑัะฐะทั

-d โ ะทะฐะฟััะบ ะฒ ัะพะฝะพะฒะพะผ ัะตะถะธะผะต

ะัะพะฒะตัะบะฐ, ััะพ ะบะพะฝัะตะนะฝะตัั ะทะฐะฟัััะธะปะธัั:
docker ps


ะั ะดะพะปะถะฝั ัะฒะธะดะตัั:

api_gateway โ Up

service_users โ Up

service_orders โ Up

๐ ะจะฐะณ 7. ะัะพะฒะตัะบะฐ ัะฐะฑะพัั API
ะะพัะผะพััะตัั ะปะพะณะธ:
docker compose logs api_gateway
docker compose logs service_users
docker compose logs service_orders


ะ ะปะพะณะฐั API Gateway ะดะพะปะถะฝะพ ะฑััั ััะพ-ัะพ ะฒัะพะดะต:

Uvicorn running on http://0.0.0.0:8000

๐งช ะขะตััะธัะพะฒะฐะฝะธะต ััะฐัััะฐ API
WSL / Linux / macOS:
curl http://localhost:8000/status

Windows ะฑัะฐัะทะตั:

ะะตัะตะนะดะธัะต ะฒ:

http://localhost:8000/status

ะะถะธะดะฐะตะผัะน ัะตะทัะปััะฐั:
{
  "status": "API Gateway is running"
}

๐ Swagger / OpenAPI

FastAPI ะฐะฒัะพะผะฐัะธัะตัะบะธ ัะพะทะดะฐัั UI:

Swagger:
http://localhost:8000/docs

ReDoc:
http://localhost:8000/redoc


Swagger ะพัะพะฑัะฐะถะฐะตั ะดะพะบัะผะตะฝัะฐัะธั ะณะปะฐะฒะฝะพะณะพ API Gateway.

๐ก๏ธ CORS (ะตัะปะธ ะธัะฟะพะปัะทัะตััั)

ะัะปะธ ะฒะบะปัััะฝ CORS, ัะพ API Gateway ะดะพะฑะฐะฒะปัะตั:

Access-Control-Allow-Origin

Access-Control-Allow-Methods

Access-Control-Allow-Headers

ะัะถะฝะฐ ัะตะบัะธั ะฒ README? โ ะดะพะฑะฐะฒะปั.

๐งฐ ะะพะปะตะทะฝัะต ะบะพะผะฐะฝะดั Docker
ะััะฐะฝะพะฒะธัั ะฟัะพะตะบั:
docker compose down

ะะตัะตะทะฐะฟััะบ:
docker compose up -d

ะะตัะตัะพะฑัะฐัั ะพะดะธะฝ ะผะธะบัะพัะตัะฒะธั:
docker compose build service_users

ะฃะดะฐะปะธัั ะฒัะต ะบะพะฝัะตะนะฝะตัั ะธ ะพะฑัะฐะทั (ะถัััะบะฐั ะพัะธััะบะฐ):
docker system prune -a

๐ Troubleshooting
โ API ะฝะต ะพัะฒะตัะฐะตั

ะัะพะฒะตัััะต ะบะพะฝัะตะนะฝะตัั:

docker ps


ะะพัะผะพััะธัะต ะปะพะณะธ:

docker compose logs api_gateway


ะะพะทะผะพะถะฝะพ, ะฟะพัั ะทะฐะฝัั โ ะฟัะพะฒะตัััะต:

netstat -tulnp | grep 8000

โ ะัะธะฑะบะฐ "Connection refused"

ะกะบะพัะตะต ะฒัะตะณะพ, ัะตัะฒะธั ะฝะต ััะฟะตะป ััะฐััะพะฒะฐัั.

ะะตัะตะฝะธะต:

docker compose restart

โ Swagger ะฟัััะพะน

ะัะพะฒะตัััะต:

ะบะพััะตะบัะฝะพััั ะผะฐัััััะพะฒ ะฒ API Gateway

ััะพ ะผะธะบัะพัะตัะฒะธัั ะดะพัััะฟะฝั ะฟะพ ัะตัะธ Docker (ะฟะพ ะธั service name)